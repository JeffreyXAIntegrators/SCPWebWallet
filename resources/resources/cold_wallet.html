<!DOCTYPE html>
<html>
  <head>
    <title>ScPrime Web Wallet</title>
    <link rel="stylesheet" href="/gui/styles.css">
    <script type="text/javascript" src="/gui/scripts.js"></script>
    <script type="text/javascript" src="/gui/wasm_exec.js"></script>
    <script>
      function addCopiedAddressIcon() {
        document.getElementById('copiedAddressIcon').innerHTML = 'üñ®Ô∏è'
      }
      function addCopiedSeedIcon() {
        document.getElementById('copiedSeedIcon').innerHTML = 'üñ®Ô∏è'
      }
      function removeCopiedAddressIcon() {
        document.getElementById('copiedAddressIcon').innerHTML = ''
      }
      function removeCopiedSeedIcon() {
        document.getElementById('copiedSeedIcon').innerHTML = ''
      }
      function displayAddress() {
        if (isAddressCollapsed) {
          var collapsedAddress = address.substring(0, 10) + '...' + address.substring(address.length - 10);
          document.getElementById('displayAddress').innerHTML = collapsedAddress
        } else {
          document.getElementById('displayAddress').innerHTML = address
        }
        removeCopiedAddressIcon()
      }
      function expandAddress() {
        isAddressCollapsed = false
        document.getElementById("collapseAddress").innerHTML = '<button onclick="collapseAddress()">Collapse</button>'
        document.getElementById("expandAddress").innerHTML = ''
        displayAddress()
      }
      function collapseAddress() {
        isAddressCollapsed = true
        document.getElementById("expandAddress").innerHTML = '<button onclick="expandAddress()">Expand</button>'
        document.getElementById("collapseAddress").innerHTML = ''
        displayAddress()
      }
      function copyAddressToClipboard() {
        copyToClipboard(address)
        addCopiedAddressIcon()
        removeCopiedSeedIcon()
      }
      function copySeedToClipboard() {
        copyToClipboard(seed)
        removeCopiedAddressIcon()
        addCopiedSeedIcon()
      }
      var address
      var seed
      var isAddressCollapsed = true
      const go = new Go();
      WebAssembly.instantiateStreaming(fetch("/gui/wallet.wasm"), go.importObject).then((result) => {
        go.run(result.instance);
        seed = newWalletSeed()
        address = addressFromSeed(seed).toLowerCase()
        document.getElementById("seed").innerHTML = seed
        collapseAddress()
        document.getElementById("copySeedToClipboard").innerHTML = `<button onclick="copySeedToClipboard()">Copy</button>`
        document.getElementById("copyAddressToClipboard").innerHTML = `<button onclick="copyAddressToClipboard()">Copy</button>`
      })
    </script>
    <meta http-equiv="PRAGMA" content="NO-CACHE">
    <meta http-equiv="CACHE-CONTROL" content="NO-CACHE">
  </head>
  <body>
    <div class="col-5 left top no-wrap">
      <div>
        <img class="scprime-logo" alt="ScPrime Web Wallet" src="/gui/logo.png"/>
      </div>
    </div>
    <div id="popup" class="popup center">
      <h2 class="uppercase">Cold Wallet</h2>
      <div class="middle pad blue-dashed" id="popup_content">
        Seed:
      </div>
      <div>
        <div id="seed" class="inline-block middle pad" id="popup_content"></div>
        <div id="copiedSeedIcon" class='inline-block cursor-help' title='seed copied to clipboard'></div>
      </div>
      <div class='pad'>
        <div id="copySeedToClipboard" class="inline-block"></div>
      </div>
      <div class="middle pad blue-dashed" id="popup_content">
        Receive Coins At:
      </div>
      <div>
        <div id="displayAddress" class="inline-block middle pad" id="popup_content"></div>
        <div id="copiedAddressIcon" class='inline-block cursor-help' title='address copied to clipboard'></div>
      </div>
      <div class='pad'>
        <div id="copyAddressToClipboard" class="inline-block"></div>
        <div id="expandAddress" class="inline-block"></div>
        <div id="collapseAddress" class="inline-block"></div>
      </div>
      <div class="middle pad blue-dashed" id="popup_content">
        <form class="inline-block" action="/?&CACHE_BUSTER;" method="get">
          <button type="submit">Close</button>
        </form>
      </div>
    </div>
    <div id="fade" class="fade"></div>
  </body>
</html>

